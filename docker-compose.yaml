version: '3.7'

volumes:
    database_data:
        driver: local

services:
    db:
        image: 'postgres:latest' #use latest official version
        ports:
            - 5431:5432
        expose:
            - 5431
        environment:
            POSTGRES_DB: thealth
            POSTGRES_USER: postgres
            POSTGRES_PASSWORD: somepassword

        volumes:
            - database_data:/var/lib/postgresql/data

    web: 
        build: .
        ports: 
            - 3000:3000
        environment: 
            POSTGRES_DB: thealth
            POSTGRES_USER: postgres
            POSTGRES_PASSWORD: somepassword
            POSTGRES_HOST: db
            POSTGRES_PORT: 5431
        env_file:
            - database.env #configure postgres
        volumes:
                - ./:/go/src/github.com/IamNator/thealth:rw

# Networks to be created to facilitate communication between containers
networks:
    fullstack: